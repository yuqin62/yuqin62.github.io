<!DOCTYPE html>
<html>
<head>
    <!--<title>Project 2</title>-->
    <style>
        body {
            padding: 30px;
            width: 1000px;
            margin: auto;
            text-align: left;
            font-weight: 300;
            font-family: Arial, sans-serif;
        }
        h1, h2, h3, h4 {
          font-family: 'Source Sans Pro', sans-serif;
        }
        h3 {
            font-weight: normal; /* Remove bold from h3 */
        }
        h4 {
        font-family: 'Source Sans Pro', sans-serif; /* Same as h3 */
        font-weight: bold; /* Make it bolder */
        }
        .center {
            text-align: center;
        }
        .image-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .image-small {
            margin: 20px;
            width: 150px;
            height: auto;
        }
        .image-medium {
            margin: 5px;
            width: 240px;
            height: auto;
        }
        .image-large {
            margin: 10px;
            width: 300px;
            height: auto;
        }
        figcaption, p {
            text-align: center;
            margin-top: 5px;
        }
        .divider {
            border-left: 10px dashed black;
            height: 100%;
            margin: 0 20px;
        }
    </style>
</head>
<body>
    <h1 align="middle">Project 2: Fun with Filters and Frequencies!</h1>
    <h1 align="middle">Filters/ Frequencies/ Sharpening/ Hybrid / Stacks/ Blending </h1>
    <h2 align="middle">Yuqin Jiao</h2>
    <br>
    <br>
    <br>
    <h2 align="middle">Part 1: Fun with Filters</h2>
    <h4 align="middle">Part 1.1: Finite Difference Operator: description of gradient magnitude computation</h4>
    <p>
        (15 points) Include a brief description of gradient magnitude computation.
        (15 points) Answer the questions asked in part 1.2
        For computing gradient magnitude, I first applied Dx([[1, -1]]) and Dy([[1], [-1]]) to convolve with one image channel, 
        then I got partical derivative x and partical derivative y. Then I used np.sqrt(partial_derivative_x**2 + partial_derivative_y**2) 
        to compute gradient_magnitude. I chose threshold = 0.2 when binarizing the gradient magnitude image, after that, I got the first 
        edge image(fig 1_1_1)
        
    </p>
    <h4 align="middle">Part 1.2: Derivative of Gaussian (DoG) Filter: convolution is commutative</h4>
    <p>
        After creating a blurred version of the original image by convolving with a gaussian, I convolved (Image * G) 
        with Dx and Dy separately, after getting new partial derivative x and y, I chose threshold = 0.04 
        to get the edge image(fig 1_2_1), the difference between the new edge image and fig 1_1_1 in Part1.1 is: the new 
        edge image has less noise, and the edge is more clear and bloder.
        To do the same thing with a single convolution, I first convolved G with Dx and Dy, then convolve the result with original 
        image, after choosing the same threshold = 0.04, I got an edge image(fig 1_2_2), which is the same result as fig 1_2_1. So the 
        same result got has been verified. This process shows that convolution is commutative.
    </p>

    <div class="image-row">
        <figure>
            <img class="image-medium" src="media/figure1_1_1.jpg" alt="Description of figure1_1_1">
            <figcaption>Edge Image from Part 1.1</figcaption>
        </figure>
        <figure>
            <img class="image-medium" src="media/figure1_2_1.jpg" alt="Description of figure1_2_1">
            <figcaption>Edge Image from Part 1.2 using (Im * G) * [Dx and Dy]</figcaption>
        </figure>
        <figure>
            <img class="image-medium" src="media/figure1_2_2.jpg" alt="Description of figure1_2_2">
            <figcaption>Edge Image from Part 1.2 using (G * [Dx and Dy]) * Im</figcaption>
        </figure>
    </div>
    <br>
    <h2 align="middle">Image Pyramid</h2>
    <p>
        To implement image pyramid, I used skimage.transform.rescale to first shrink the resolution of image channel, 
        then if the rescaled channel is over 300x300 resolution, I use recursive to process on a smaller image resolution, 
        after the recursive, I upscale the image to original resolution, also double the displacemment( for finding the  
        smallest score and the best displacement, I used the same L2 norm to calculate as naive approach with np.roll to 
        shift the channel).

        Aftering align the images, I used 0.85 scale crop to cut each channel's margin off to make the output image looks better.

        <br>
        Other image displacement:
        <br>
        melons: G (2, 30) R (-8, -34)
        <br>
        sculpture: G (4, -64) R (52, 86)
        <br>
        self_portrait: G (-14, 82) R (22, -94)
        <br>
        train: G (-6, -88) R (0, 0)
    </p>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/lady1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/lady2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (12, -28) R (8, 30)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/three_generations1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/three_generations2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (2, -22) R (10, 30)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/icon1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/icon2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (-2, -14) R (8, 30)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/onion_church1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/onion_church2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (-26, -20) R (10, 30)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/church1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/church2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (12, -6) R (22, -22)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/person1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <p align="middle">This image downloaded from "Prokudin-Gorskii collection"</p>
        <figure>
            <img class="image-large" src="media/person2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (-10, -14) R (-6, 30)</figcaption>
        </figure>
    </div>
    
    <div class="image-row">
        <figure>
            <img class="image-large" src="media/stone1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <p align="middle">This image downloaded from "Prokudin-Gorskii collection"</p>
        <figure>
            <img class="image-large" src="media/stone2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (4, -44) R (4, -20)</figcaption>
        </figure>
    </div>

    <div class="image-row">
        <figure>
            <img class="image-large" src="media/emir1.jpg" alt="Description of cathedral">
            <figcaption>Output of Naive Approach</figcaption>
        </figure>
        <p align="middle">For the "emir" image, I also used SSIM from skimage.metrics to make the alignment look better. The SSIM score 
            is computed as the higher the better.</p>
        <figure>
            <img class="image-large" src="media/emir2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (-10, 0) R (6, -16)</figcaption>
        </figure>
    </div>

    <p align="middle">The issue in my alignment is after rescaling several times, the images go blurry, although the alignment is ok. I tried 
        to make anti-aliasing = True or False, but the result is similiar. Since the instruction on ed says "anti-alias will blur the image before downsizing and 
        we'll learn about this in lecture this coming week", I think it is ok for now, but I'll try to fix the blur issue after I learn more.
    </p>
    <br>
    <h2 align="middle">Bells & Whistles</h2>
    <p>
        I found an image from pinterest website, and I used photoshop to make it into 3 RGB channels, after that, I put the image as input, 
        and used the same image pyramid function as described above to align the channels, and then got the output image.
    </p>
    <div class="image-row">
        <figure>
            <img class="image-small" src="media/scene.jpg" alt="Description of cathedral">
            <figcaption>Input Image</figcaption>
        </figure>
        <figure>
            <img class="image-large" src="media/scene2.jpg" alt="Description of tobolsk">
            <figcaption>Using Pyramid: G (-2, 0) R (-2, -2)</figcaption>
        </figure>
    </div>
        

</body>
</html>

        <!--monastery Displacement: dx = 0, dy = -6 Displacement: dx = 1, dy = 9
        cathedral Displacement: dx = -1, dy = 1 Displacement: dx = -1, dy = 7
        tobolsk Displacement: dx = 2, dy = 3 Displacement: dx = 3, dy = 6

        three_generations Displacement: dx = 2, dy = -22 Displacement: dx = 10, dy = 30
        onion_church Displacement: dx = -26, dy = -20 Displacement: dx = 10, dy = 30
        lady Displacement: dx = 12, dy = -28 Displacement: dx = 8, dy = 30
        icon Displacement: dx = -2, dy = -14 Displacement: dx = 8, dy = 30
        harvesters Displacement: dx = -18, dy = -8 Displacement: dx = -12, dy = 30
        emir Displacement: dx = -10, dy = 0 Displacement: dx = 6, dy = -16
        church Displacement: dx = 12, dy = -6 Displacement: dx = 22, dy = -22
        train Displacement: dx = -14, dy = -8 Displacement: dx = 4, dy = 30
        sculpture Displacement: dx = 22, dy = 22 Displacement: dx = -18, dy = 30
        emir Displacement: dx = 14, dy = -6 Displacement: dx = 30, dy = 30

        scene Displacement: dx = -2, dy = 0 isplacement: dx = -2, dy = -2-->